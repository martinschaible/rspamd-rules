# ==============================================================================
# Phishing obfuscation detection patterns
#
# Detects text obfuscated with zero-width Unicode characters
# Common in phishing emails to bypass spam filters
#
# Zero-width characters used by spammers:
# U+200B (Zero Width Space)
# U+200C (Zero Width Non-Joiner)
# U+200D (Zero Width Joiner)
# U+FEFF (Zero Width No-Break Space / BOM)
# ------------------------------------------------------------------------------
# Language: german
# Weight:   6.0
# ==============================================================================

# Generic pattern: detects 3+ letters with obfuscation chars between them
# Matches obfuscated words regardless of content
# Using actual UTF-8 characters instead of \x{} syntax for Hyperscan compatibility

# Zero-width characters between letters
/[a-zäöüß][​‌‍﻿][a-zäöüß][​‌‍﻿][a-zäöüß]/i

# Soft Hyphen obfuscation (HTML &shy; = U+00AD)
# Spammers insert soft hyphens to break up words: me&shy;ssage&shy;s
/[a-zäöüß]­[a-zäöüß]­[a-zäöüß]/i
- require at least 2 obfuscation characters
# ------------------------------------------------------------------------------
# Patterns require minimum 2 obfuscation chars to avoid false positives

# Aktualisierung / Aktualisieren
/a[​‌‍﻿­]+k[​‌‍﻿­]*t[​‌‍﻿­]*u[​‌‍﻿­]*a[​‌‍﻿­]+l[​‌‍﻿­]*i[​‌‍﻿­]*s[​‌‍﻿­]*i[​‌‍﻿­]*e[​‌‍﻿­]*r/i

# Bestätigung / Bestätigen
/b[​‌‍﻿­]+e[​‌‍﻿­]*s[​‌‍﻿­]*t[​‌‍﻿­]+[äa][​‌‍﻿­]*t[​‌‍﻿­]*i[​‌‍﻿­]*g/i

# Dringend
/d[​‌‍﻿­]+r[​‌‍﻿­]*i[​‌‍﻿­]*n[​‌‍﻿­]*g[​‌‍﻿­]+e[​‌‍﻿­]*n[​‌‍﻿­]*d/i

# Kontaktdaten
/k[​‌‍﻿­]+o[​‌‍﻿­]*n[​‌‍﻿­]*t[​‌‍﻿­]*a[​‌‍﻿­]+k[​‌‍﻿­]*t/i

# Konto / Kontostand
/k[​‌‍﻿­]+o[​‌‍﻿­]*n[​‌‍﻿­]+t[​‌‍﻿­]*o/i

# Kunde
/k[​‌‍﻿­]+u[​‌‍﻿­]*n[​‌‍﻿­]+d[​‌‍﻿­]*e/i

# Kundin
/k[​‌‍﻿­]+u[​‌‍﻿­]*n[​‌‍﻿­]+d[​‌‍﻿­]*i[​‌‍﻿­]*n/i

# Passwort
/p[​‌‍﻿­]+a[​‌‍﻿­]*s[​‌‍﻿­]*s[​‌‍﻿­]+w[​‌‍﻿­]*o[​‌‍﻿­]*r[​‌‍﻿­]*t/i

# Sicherheit / Sicherheitsmaßnahmen
/s[​‌‍﻿­]+i[​‌‍﻿­]*c[​‌‍﻿­]*h[​‌‍﻿­]+e[​‌‍﻿­]*r[​‌‍﻿­]*h[​‌‍﻿­]*e[​‌‍﻿­]*i[​‌‍﻿­]*t/i

# Sofort / Sofortig
/s[​‌‍﻿­]+o[​‌‍﻿­]*f[​‌‍﻿­]+o[​‌‍﻿­]*r[​‌‍﻿­]*t/i

# Überprüfung / Überprüfen
/[uü][​‌‍﻿­]+b[​‌‍﻿­]*e[​‌‍﻿­]*r[​‌‍﻿­]+p[​‌‍﻿­]*r[​‌‍﻿­]*[uü][​‌‍﻿­]*f/i

# Verifizierung / Verifizieren
/v[​‌‍﻿­]+e[​‌‍﻿­]*r[​‌‍﻿­]*i[​‌‍﻿­]+f[​‌‍﻿­]*i[​‌‍﻿­]*z[​‌‍﻿­]*i[​‌‍﻿­]*e[​‌‍﻿­]*r/i

# Zahlung / Zahlungsproblem
/z[​‌‍﻿­]+a[​‌‍﻿­]*h[​‌‍﻿­]+l[​‌‍﻿­]*u[​‌‍﻿­]*n[​‌‍﻿­]*g/i

# Telefonnummer
/t[​‌‍﻿­]+e[​‌‍﻿­]*l[​‌‍﻿­]*e[​‌‍﻿­]+f[​‌‍﻿­]*o[​‌‍﻿­]*n/i

# Zugriffsbeschränkung / Zugriff
/z[​‌‍﻿­]+u[​‌‍﻿­]*g[​‌‍﻿­]+r[​‌‍﻿­]*i[​‌‍﻿­]*f[​‌‍﻿­]*f/i

# Online-Service / Online-Dienst
/o[​‌‍﻿­]+n[​‌‍﻿­]*l[​‌‍﻿­]+i[​‌‍﻿­]*n[​‌‍﻿­]*e/i

# Reibungslos
/r[​‌‍﻿­]+e[​‌‍﻿­]*i[​‌‍﻿­]*b[​‌‍﻿­]+ optionalen Obfuskationszeichen)
/o[​‌‍﻿­]*n[​‌‍﻿­]*l[​‌‍﻿­]*i[​‌‍﻿­]*n[​‌‍﻿­]*e/i

# Reibungslos (mit optionalen Obfuskationszeichen)
/r[​‌‍﻿­]*e[​‌‍﻿­]*i[​‌‍﻿­]*b[​‌‍﻿­]*u[​‌‍﻿­]*n[​‌‍﻿­]*g[​‌‍﻿­]*s[​‌‍﻿­]*l[​‌‍﻿­]*o[​‌‍﻿­]*s/i