# ==============================================================================
# Phishing obfuscation detection patterns
#
# Detects text obfuscated with zero-width Unicode characters
# Common in phishing emails to bypass spam filters
#
# Zero-width characters used by spammers:
# U+200B (Zero Width Space)
# U+200C (Zero Width Non-Joiner)
# U+200D (Zero Width Joiner)
# U+FEFF (Zero Width No-Break Space / BOM)
# ------------------------------------------------------------------------------
# Language: german
# Weight:   6.0
# ==============================================================================

# Generic pattern: detects 3+ letters with zero-width chars between them
# Matches obfuscated words regardless of content
# Using actual UTF-8 characters instead of \x{} syntax for Hyperscan compatibility

/[a-zäöüß][​‌‍﻿][a-zäöüß][​‌‍﻿][a-zäöüß]/i

# Soft Hyphen obfuscation (HTML &shy; = U+00AD)
# Spammers insert soft hyphens to break up words: me&shy;ssage&shy;s
/[a-zäöüß]­[a-zäöüß]­[a-zäöüß]/i

# Specific phishing terms with ONLY zero-width characters
# ------------------------------------------------------------------------------
# Using actual UTF-8 characters for Hyperscan compatibility

# Aktualisierung / Aktualisieren (mit optionalen Obfuskationszeichen)
/a[​‌‍﻿­]*k[​‌‍﻿­]*t[​‌‍﻿­]*u[​‌‍﻿­]*a[​‌‍﻿­]*l[​‌‍﻿­]*i[​‌‍﻿­]*s[​‌‍﻿­]*i[​‌‍﻿­]*e[​‌‍﻿­]*r[​‌‍﻿­]*e[​‌‍﻿­]*n/i

# Bestätigung / Bestätigen (mit optionalen Obfuskationszeichen)
/b[​‌‍﻿­]*e[​‌‍﻿­]*s[​‌‍﻿­]*t[​‌‍﻿­]*[äa][​‌‍﻿­]*t[​‌‍﻿­]*i[​‌‍﻿­]*g[​‌‍﻿­]*e[​‌‍﻿­]*n/i

# Dringend (mit optionalen Obfuskationszeichen)
/d[​‌‍﻿­]*r[​‌‍﻿­]*i[​‌‍﻿­]*n[​‌‍﻿­]*g[​‌‍﻿­]*e[​‌‍﻿­]*n[​‌‍﻿­]*d/i

# Kontaktdaten (mit optionalen Obfuskationszeichen)
/k[​‌‍﻿­]*o[​‌‍﻿­]*n[​‌‍﻿­]*t[​‌‍﻿­]*a[​‌‍﻿­]*k[​‌‍﻿­]*t[​‌‍﻿­]*d[​‌‍﻿­]*a[​‌‍﻿­]*t[​‌‍﻿­]*e[​‌‍﻿­]*n/i

# Konto / Kontostand (mit optionalen Obfuskationszeichen)
/k[​‌‍﻿­]*o[​‌‍﻿­]*n[​‌‍﻿­]*t[​‌‍﻿­]*o/i

# Kunde (mit optionalen Obfuskationszeichen)
/k[​‌‍﻿­]*u[​‌‍﻿­]*n[​‌‍﻿­]*d[​‌‍﻿­]*e/i

# Kundin (mit optionalen Obfuskationszeichen)
/k[​‌‍﻿­]*u[​‌‍﻿­]*n[​‌‍﻿­]*d[​‌‍﻿­]*i[​‌‍﻿­]*n/i

# Passwort (mit optionalen Obfuskationszeichen)
/p[​‌‍﻿­]*a[​‌‍﻿­]*s[​‌‍﻿­]*s[​‌‍﻿­]*w[​‌‍﻿­]*o[​‌‍﻿­]*r[​‌‍﻿­]*t/i

# Sicherheit / Sicherheitsmaßnahmen (mit optionalen Obfuskationszeichen)
/s[​‌‍﻿­]*i[​‌‍﻿­]*c[​‌‍﻿­]*h[​‌‍﻿­]*e[​‌‍﻿­]*r[​‌‍﻿­]*h[​‌‍﻿­]*e[​‌‍﻿­]*i[​‌‍﻿­]*t/i

# Sofort / Sofortig (mit optionalen Obfuskationszeichen)
/s[​‌‍﻿­]*o[​‌‍﻿­]*f[​‌‍﻿­]*o[​‌‍﻿­]*r[​‌‍﻿­]*t/i

# Überprüfung / Überprüfen (mit optionalen Obfuskationszeichen)
/[uü][​‌‍﻿­]*b[​‌‍﻿­]*e[​‌‍﻿­]*r[​‌‍﻿­]*p[​‌‍﻿­]*r[​‌‍﻿­]*[uü][​‌‍﻿­]*f[​‌‍﻿­]*e[​‌‍﻿­]*n/i

# Verifizierung / Verifizieren (mit optionalen Obfuskationszeichen)
/v[​‌‍﻿­]*e[​‌‍﻿­]*r[​‌‍﻿­]*i[​‌‍﻿­]*f[​‌‍﻿­]*i[​‌‍﻿­]*z[​‌‍﻿­]*i[​‌‍﻿­]*e[​‌‍﻿­]*r[​‌‍﻿­]*e[​‌‍﻿­]*n/i

# Zahlung / Zahlungsproblem (mit optionalen Obfuskationszeichen)
/z[​‌‍﻿­]*a[​‌‍﻿­]*h[​‌‍﻿­]*l[​‌‍﻿­]*u[​‌‍﻿­]*n[​‌‍﻿­]*g/i

# Kontaktinformation / Kontaktdaten (mit optionalen Obfuskationszeichen)
/k[​‌‍﻿­]*o[​‌‍﻿­]*n[​‌‍﻿­]*t[​‌‍﻿­]*a[​‌‍﻿­]*k[​‌‍﻿­]*t/i

# Telefonnummer (mit optionalen Obfuskationszeichen)
/t[​‌‍﻿­]*e[​‌‍﻿­]*l[​‌‍﻿­]*e[​‌‍﻿­]*f[​‌‍﻿­]*o[​‌‍﻿­]*n/i

# Zugriffsbeschränkung / Zugriff (mit optionalen Obfuskationszeichen)
/z[​‌‍﻿­]*u[​‌‍﻿­]*g[​‌‍﻿­]*r[​‌‍﻿­]*i[​‌‍﻿­]*f[​‌‍﻿­]*f/i

# Online-Service / Online-Dienst (mit optionalen Obfuskationszeichen)
/o[​‌‍﻿­]*n[​‌‍﻿­]*l[​‌‍﻿­]*i[​‌‍﻿­]*n[​‌‍﻿­]*e/i

# Reibungslos (mit optionalen Obfuskationszeichen)
/r[​‌‍﻿­]*e[​‌‍﻿­]*i[​‌‍﻿­]*b[​‌‍﻿­]*u[​‌‍﻿­]*n[​‌‍﻿­]*g[​‌‍﻿­]*s[​‌‍﻿­]*l[​‌‍﻿­]*o[​‌‍﻿­]*s/i