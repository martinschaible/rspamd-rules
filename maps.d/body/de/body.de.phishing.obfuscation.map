# ==============================================================================
# Phishing obfuscation detection patterns
#
# Detects text obfuscated with zero-width Unicode characters
# Common in phishing emails to bypass spam filters
#
# Zero-width characters used by spammers:
# U+200B (Zero Width Space)
# U+200C (Zero Width Non-Joiner)
# U+200D (Zero Width Joiner)
# U+FEFF (Zero Width No-Break Space / BOM)
# ------------------------------------------------------------------------------
# Language: german
# Weight:   6.0
# ==============================================================================

# Generic pattern: detects 3+ letters with zero-width chars between them
# Matches obfuscated words regardless of content
# Using actual UTF-8 characters instead of \x{} syntax for Hyperscan compatibility

/[a-zäöüß][​‌‍﻿][a-zäöüß][​‌‍﻿][a-zäöüß]/i 0.1

# Soft Hyphen obfuscation (HTML &shy; = U+00AD)
# Spammers insert soft hyphens to break up words: me&shy;ssage&shy;s
/[a-zäöüß][­][a-zäöüß][­][a-zäöüß]/i

# Specific phishing terms with ONLY zero-width characters
# ------------------------------------------------------------------------------
# Using actual UTF-8 characters for Hyperscan compatibility

# Zahlung / Zahlungsproblem
/z[​‌‍﻿]+a[​‌‍﻿]+h[​‌‍﻿]+l[​‌‍﻿]+u[​‌‍﻿]+n[​‌‍﻿]+g/i

# Konto / Kontostand
/k[​‌‍﻿]+o[​‌‍﻿]+n[​‌‍﻿]+t[​‌‍﻿]+o/i

# Passwort
/p[​‌‍﻿]+a[​‌‍﻿]+s[​‌‍﻿]+s[​‌‍﻿]+w[​‌‍﻿]+o[​‌‍﻿]+r[​‌‍﻿]+t/i

# Überprüfung / Überprüfen
/[uü][​‌‍﻿]+b[​‌‍﻿]+e[​‌‍﻿]+r[​‌‍﻿]+p[​‌‍﻿]+r[​‌‍﻿]+[uü][​‌‍﻿]+f/i

# Bestätigung / Bestätigen
/b[​‌‍﻿]+e[​‌‍﻿]+s[​‌‍﻿]+t[​‌‍﻿]+[äa][​‌‍﻿]+t[​‌‍﻿]+i[​‌‍﻿]+g/i

# Verifizierung / Verifizieren
/v[​‌‍﻿]+e[​‌‍﻿]+r[​‌‍﻿]+i[​‌‍﻿]+f[​‌‍﻿]+i[​‌‍﻿]+z[​‌‍﻿]+i[​‌‍﻿]+e[​‌‍﻿]+r/i

# Sicherheit
/s[​‌‍﻿]+i[​‌‍﻿]+c[​‌‍﻿]+h[​‌‍﻿]+e[​‌‍﻿]+r[​‌‍﻿]+h[​‌‍﻿]+e[​‌‍﻿]+i[​‌‍﻿]+t/i

# Dringend
/d[​‌‍﻿]+r[​‌‍﻿]+i[​‌‍﻿]+n[​‌‍﻿]+g[​‌‍﻿]+e[​‌‍﻿]+n[​‌‍﻿]+d/i

# Sofort / Sofortig
/s[​‌‍﻿]+o[​‌‍﻿]+f[​‌‍﻿]+o[​‌‍﻿]+r[​‌‍﻿]+t/i

# Aktualisierung / Aktualisieren
/a[​‌‍﻿]+k[​‌‍﻿]+t[​‌‍﻿]+u[​‌‍﻿]+a[​‌‍﻿]+l[​‌‍﻿]+i[​‌‍﻿]+s[​‌‍﻿]+i[​‌‍﻿]+e[​‌‍﻿]+r/i
