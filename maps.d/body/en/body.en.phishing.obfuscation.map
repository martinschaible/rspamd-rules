# ==============================================================================
# Phishing obfuscation detection patterns
#
# Detects text obfuscated with zero-width Unicode characters
# Common in phishing emails to bypass spam filters
#
# Zero-width characters used by spammers:
# U+200B (Zero Width Space)
# U+200C (Zero Width Non-Joiner)
# U+200D (Zero Width Joiner)
# U+FEFF (Zero Width No-Break Space / BOM)
# ------------------------------------------------------------------------------
# Language: english
# Weight:   6.0
# ==============================================================================

# Generic pattern: detects 3+ letters with zero-width chars between them
# Matches obfuscated words regardless of content
# Using actual UTF-8 characters for Hyperscan compatibility

/[a-z][​‌‍﻿][a-z][​‌‍﻿][a-z]/i 0.1

# Soft Hyphen obfuscation (HTML &shy; = U+00AD)
# Spammers insert soft hyphens to break up words: me&shy;ssage&shy;s
/[a-z][­][a-z][­][a-z]/i

# Specific phishing terms with ONLY zero-width characters
# ------------------------------------------------------------------------------
# Using actual UTF-8 characters for Hyperscan compatibility

# Payment
/p[​‌‍﻿]+a[​‌‍﻿]+y[​‌‍﻿]+m[​‌‍﻿]+e[​‌‍﻿]+n[​‌‍﻿]+t/i

# Account
/a[​‌‍﻿]+c[​‌‍﻿]+c[​‌‍﻿]+o[​‌‍﻿]+u[​‌‍﻿]+n[​‌‍﻿]+t/i

# Password
/p[​‌‍﻿]+a[​‌‍﻿]+s[​‌‍﻿]+s[​‌‍﻿]+w[​‌‍﻿]+o[​‌‍﻿]+r[​‌‍﻿]+d/i

# Verify / Verification
/v[​‌‍﻿]+e[​‌‍﻿]+r[​‌‍﻿]+i[​‌‍﻿]+f[​‌‍﻿]+[yi]/i

# Confirm / Confirmation
/c[​‌‍﻿]+o[​‌‍﻿]+n[​‌‍﻿]+f[​‌‍﻿]+i[​‌‍﻿]+r[​‌‍﻿]+m/i

# Security / Secure
/s[​‌‍﻿]+e[​‌‍﻿]+c[​‌‍﻿]+u[​‌‍﻿]+r[​‌‍﻿]+[ei]/i

# Urgent
/u[​‌‍﻿]+r[​‌‍﻿]+g[​‌‍﻿]+e[​‌‍﻿]+n[​‌‍﻿]+t/i

# Immediate / Immediately
/i[​‌‍﻿]+m[​‌‍﻿]+m[​‌‍﻿]+e[​‌‍﻿]+d[​‌‍﻿]+i[​‌‍﻿]+a[​‌‍﻿]+t[​‌‍﻿]+e/i

# Update / Updating
/u[​‌‍﻿]+p[​‌‍﻿]+d[​‌‍﻿]+a[​‌‍﻿]+t[​‌‍﻿]+[ei]/i

# Suspend / Suspended / Suspension
/s[​‌‍﻿]+u[​‌‍﻿]+s[​‌‍﻿]+p[​‌‍﻿]+e[​‌‍﻿]+n[​‌‍﻿]+[ds]/i

# Action Required
/a[​‌‍﻿]+c[​‌‍﻿]+t[​‌‍﻿]+i[​‌‍﻿]+o[​‌‍﻿]+n/i

# Expire / Expired / Expiring
/e[​‌‍﻿]+x[​‌‍﻿]+p[​‌‍﻿]+i[​‌‍﻿]+r[​‌‍﻿]+[ei]/i

# Validate / Validation
/v[​‌‍﻿]+a[​‌‍﻿]+l[​‌‍﻿]+i[​‌‍﻿]+d[​‌‍﻿]+a[​‌‍﻿]+t[​‌‍﻿]+[ei]/i

# Unauthorized
/u[​‌‍﻿]+n[​‌‍﻿]+a[​‌‍﻿]+u[​‌‍﻿]+t[​‌‍﻿]+h[​‌‍﻿]+o[​‌‍﻿]+r[​‌‍﻿]+i[​‌‍﻿]+z[​‌‍﻿]+e[​‌‍﻿]+d/i

# Unusual / Unusual Activity
/u[​‌‍﻿]+n[​‌‍﻿]+u[​‌‍﻿]+s[​‌‍﻿]+u[​‌‍﻿]+a[​‌‍﻿]+l/i

# Locked / Lock
/l[​‌‍﻿]+o[​‌‍﻿]+c[​‌‍﻿]+k[​‌‍﻿]+e[​‌‍﻿]*d[​‌‍﻿]*/i

# Limited / Limit
/l[​‌‍﻿]+i[​‌‍﻿]+m[​‌‍﻿]+i[​‌‍﻿]+t[​‌‍﻿]+e[​‌‍﻿]*d[​‌‍﻿]*/i

# Blocked / Block
/b[​‌‍﻿]+l[​‌‍﻿]+o[​‌‍﻿]+c[​‌‍﻿]+k[​‌‍﻿]+e[​‌‍﻿]*d[​‌‍﻿]*/i
